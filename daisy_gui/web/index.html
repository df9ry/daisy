<!DOCTYPE html>
<html>

<!-- 
Copyright 2017 Tania Hagn

This file is part of Daisy.

   Daisy is free software: you can redistribute it and/or modify
   it under the terms of the GNU General Public License as published by
   the Free Software Foundation, either version 3 of the License, or
   (at your option) any later version.

   Daisy is distributed in the hope that it will be useful,
   but WITHOUT ANY WARRANTY; without even the implied warranty of
   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   GNU General Public License for more details.

   You should have received a copy of the GNU General Public License
   along with Daisy.  If not, see <http://www.gnu.org/licenses/>.
 -->

<head>
  <script>
    // WARNING: DO NOT set the <base href> like this in production!
    // Details: https://webdev.dartlang.org/angular/guide/router
    (function () {
      var m = document.location.pathname.match(/^(\/[-\w]+)+\/web($|\/)/);
      document.write('<base href="' + (m ? m[0] : '/') + '" />');
    }());
  </script>
  
  <script>
  function create_gauges() {
    var smeter = 0;
    var temp = 20;
    var temp_dir = true;
    var smeter_gauge = new RadialGauge({
	    renderTo: 'smeter-gauge',
	    width: 300, height: 300, units: "dBm",
	    minValue: -120, maxValue: 0, startAngle: 60, ticksAngle: 240,
	    valueBox: true,
	    majorTicks: [
	        "-120","-110","-100", "-90", "-80", "-70",
	        "-60",  "-50", "-40", "-30", "-20", "-10",
	        "0"
	    ],
	    minorTicks: 2, strokeTicks: true, highlights: [
	        {
	            "from": -120,
	            "to": -100,
	            "color": "rgba(200, 50, 50, .75)"
	        }
	    ],
	    colorPlate: "#fff", borderShadowWidth: 5, borders: true,
	    needleType: "arrow", needleWidth: 2, needleCircleSize: 7,
	    needleCircleOuter: true, needleCircleInner: false,
	    animationDuration: 900, animationRule: "linear", valueDec: 0
	}).draw();
    
    var temp_gauge = new LinearGauge({
        renderTo: 'temp-gauge',
        width: 400, height: 150, units: "Â°C", title: "Chip Temperature",
        minValue: -64, maxValue: 64,
        majorTicks: [
            -60, -50, -40, -30, -20, -10,
              0,
             10,  20,  30,  40,  50,  60
        ],
        minorTicks: 5,
        strokeTicks: true,
        ticksWidth: 15,
        ticksWidthMinor: 7.5,
        highlights: [
            { "from": -50, "to": -20, "color": "rgba(0, 0, 255, .3)" },
            { "from": -20, "to": -50, "color": "rgba(0, 0, 255, .3)" },
            { "from":  50, "to":  64, "color": "rgba(255, 0, 0, .3)" }
        ],
        colorMajorTicks: "#ffe66a", colorMinorTicks: "#ffe66a",
        colorTitle: "#eee", colorUnits: "#ccc", colorNumbers: "#eee",
        colorPlate: "#2465c0", colorPlateEnd: "#327ac0",
        borderShadowWidth: 0, borders: false, borderRadius: 10,
        needleType: "arrow", needleWidth: 3, animationDuration: 1500,
        animationRule: "linear", colorNeedle: "#222", colorNeedleEnd: "",
        colorBarProgress: "#327ac0", colorBar: "#f5f5f5",
        barStroke: 0, barWidth: 8, barBeginCircle: false
    }).draw();
    
    setInterval(function(){
    	smeter -= 11.31;
    	if (smeter < -120)
    		smeter = 0;
    	smeter_gauge.value = smeter;
    	smeter_gauge.draw();
    	
    	if ((temp < -64) || (temp > 63))
    		temp_dir = !temp_dir;
   		temp += temp_dir ? +2.33 : -1.29;
    	temp_gauge.value = temp;
    	temp_gauge.draw();
    }, 1000);
  }
  </script>
  
  <title>Daisy GUI</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" type="image/png" href="favicon.png">
  
  <script defer src="main.dart" type="application/dart"></script>
  <script defer src="packages/browser/dart.js"></script>
  <script defer src="gauge.min.js"></script>
</head>

<body onload="create_gauges();">
<div>
  <my-app>Loading...</my-app>
</div>
<div style="text-align:center;">
  <div style="margin: 5 0 5 0;">
    <canvas id="smeter-gauge"></canvas>
  </div>
  <div style="margin: 5 0 5 0;">
    <canvas id="temp-gauge"  ></canvas>
  </div>
</div>

</body>

</html>